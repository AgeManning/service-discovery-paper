%!TEX root = ../main.tex
%=========================================================

\section{System model}
\label{sec:model}

%\michal{Say we build on top of the DHT. What do we need from the DHT?}
%\michal{Those are speerate layers.}
We assume a network of nodes. At startup time, each node generates a public/secret key pair, which it uses to secure point-to-point communication with its peers. Nodes are identified by their \emph{node ID}, which is simply the hash of their public key. We assume that multiple nodes may share the same IP address (due to NAT or being hosted by the same physical machine). However, two nodes cannot share the same ID.

Our system, \sysname, is built on the existing Ethereum DHT\footnote{At the time of writing, the Ethereum DHT consist of 3,500-5,000 nodes.}, \ie nodes use the Ethereum DHT to bootstrap and initially discover nodes to fill their tables. Specifically, we designed and implemented our system as an extension of Ethereum's \emph{Node Discovery Protocol v5 (discv5)}. However, the operation of service discovery is not Ethereum-specific and could also be implemented using a different DHT.

\sysname indexes participants according to \emph{topics}. A topic is an identifier for a
service or application provided by a node. Topics are 256-bit integers, like node IDs.

A node providing a certain service (topic), is said to \emph{register} an advertisement for itself when it registers the ad on a registrar to make itself discoverable under that topic. Depending on the needs of the application, a node can advertise multiple topics or no topics at all. We assume that the popularity of topics in the system may vary significantly and follows a power law distribution~\cite{kim2018measuring}. Any can participate in registering and searching for multiple topics and uses the same ID and IP for all topics.

\felix{Can we remove this role list?}

Nodes fulfill the following roles in the network:

\begin{itemize}
    \item \textbf{Registrar} - accepts advertisements and responds to topic queries. When asked for a specific topic, a registrar responds with nodes that registered for the topic.  All DHT nodes act as Registrars. A Registrar holds advertisements for multiple topics.
    \item \textbf{Advertiser} - registers for a specific topic and wants to be discovered by its peers. The advertisers make themselves discoverable by placing advertisements. Nodes are advertisers for every topic/service it provides.
    \item \textbf{Searcher} - attempts to discover nodes for a specific topic.
\end{itemize}

\subsection{Threat Model}

Our system is designed to operate in an adversarial environment, \ie. the Internet. We assume the presence of malicious actors in the DHT. These actors do not strictly follow the protocol when communicating with others, and attempt to influence the discovery results of honest nodes by steering them toward the attacker-controlled nodes.

Security of the service discovery mechanism against attacks is fundamentally dependent on the security guarantees provided by the underlying DHT implementation. This is because the DHT's basic protocol is used to initialize and maintain the data structures used by the service discovery layer.

\michal{List DHT's guarantees here.}

Malicious actors can spawn multiple virtual nodes within one physical machine and thus control many node IDs. Maintaining nodes in the DHT requires infrastructure resources (public IP addresses) and we assume the resources under the control of an attacker are limited. Specifically, we assume that it is easier for an attacker to generate similar IP addresses (within a single subnet) than it is is to control many diverse IP addresses (with different prefixes). We use the number of IP addresses and IDs under the control of an attacker as parameters for our evaluation in Section \ref{sec:eval}.

% As creating a node requires maintaining periodic, encrypted communication with its peers, the number of active IDs an attacker can posses at a time is limited.

%Regardless of the number of the attacker, we assume that no honest node is fully eclipsed by the malicious ones. \textit{I.e.,} each honest DHT node has at least one honest peer.
%
%\sergi{we assume this or is it a requirement for the design? Maybe last sentence shouldn't go in this section \michal{I'd say both. We assume this and it's a requirement for our design. IMO, this is something we take for granted and don't propose anything to enhance it. Note, it's about eclipsing DHT nodes not about the the eclipse attack within a topic that we investigate later.}}
