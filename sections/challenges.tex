\section{Objectives}
\label{sec:objectives}

In this section, we discuss the objectives of \sysname design under four main categories: efficiency, fairness and security of the discovery system.

\michal{Shall we discuss functional objectives as well here?}

\para{Efficiency} \sysname is efficient in terms of messages exchanged, the number of contacted nodes, computation and storage requirements for both lookup and registration operations. The message exchanged and the number of contacted nodes increase logarithmically with the number of system participants. Placing an ad and processing an incoming registration request involve only simple operations involving a constant amount of computational resources. The storage usage for the registrars is limited by a configurable, but fixed amount regardless of the incoming traffic. 

\michal{Time to discover (should we measure that? maybe just make sure that everyone is discovered the same number of time under fairness below?)}

\michal{An equal load balance might be too strong for us. We do have some minor (but still) differences in the traffic received}
\para{Fairness} \sysname ensures an equal load balance across systems participants and DHT regions (\ie avoids hotspots). The system provides efficient lookup and registration operations for all the participants regardless of the topic they look up/register for. Each advertiser has a similar chance of being discovered by its peers. 

\para{Security} As an open, permissionless system, \sysname must operate securely in a Byzantine environment.  Completely eliminating Sybil/malicious peers from the discoved peers is technically impossible. However, \sysname provides efficiency and fairness for all the honest participants under the presence of a powerful attacker and increases the cost of launching such attacks. We provide a complete list of malicious behaviours \sysname protects from in \Cref{sec:eval}.
%Therefore, \sysname (such as the access control) must ensure that adversaries require as many physical machines as possible to launch successful eclipse attacks or disrupt discovery for a target application.

%In addition, \sysname must also ensure \textit{fair allocation} of storage resources by different topics to prevent starvation of unpopular topics (\textbf{G1}). To achieve fair allocation of the registry, while also securing it against poisoning, registrars must exercise \textit{access control} to select which ads are stored. While an access control mechanism cannot completely prevent poisoning in a trustless P2P setting, it should at least make it difficult or expensive for a single adversary to overrun registries using its Sybils. As we explain in \Cref{sec:overview}, registrars achieve these objectives by shaping the incoming ad registration requests, prioritising ads which contribute most to the diversity of nodes in the registry.




%With good load-balancing, all nodes in \sysname incur approximately equal overhead from registration and search operations (\textbf{G3}). We consider \textit{message traffic, computation, and storage requirements} of search/registration operations as 'overhead'. At the same time, \sysname must provide efficient registration and discovery in terms of their impact on the network, timeliness\footnote{Ideally, topic search should be fast even when the number of advertisers for a topic is much smaller than the number of all live nodes.} and robustness of search/registration operations (\textbf{G4, G5, G6}) in the face of peer churn (\textbf{G8}) and existence of access control measures. Also, the efficiency in discovery should apply equally to all the advertisers within a topic so that they each have a similar probability of being discovered (\textbf{G2}).
%\michal{The text below should be merged into the overview or later}
%Because each and every node can be an advertisement medium for any topic, the main challenge in discovery is finding the ``right'' subset of registrars to \textit{distribute the ads} so that search and registration operations efficiently meet at common nodes independent of topic popularity. The choice of the registrar subset also determines the level of load-balancing across peers, and consequently impacts security as discussed above. Therefore, the \textit{ad distribution} mechanism is central to the \sysname design. Below, we discuss two possible approaches for ad distribution that each use different subsets of nodes as registrars.

% Other important objectives are the efficiency of \sysname in terms of speed of discovery and limiting of messaging, computational and state maintenance overheads at acceptable levels. A timely discovery requires advertisers and searchers for a particular topic to quickly meet at common registrars.

%The first approach is to use the Kademlia (or any other similar DHT implementation), where the default \emph{put} and \emph{get} operations would store all the ads for topics on the (rendezvous) nodes whose IDs are closest to the hash of the topic. Although advertisers and searchers can quickly meet at common registrars with efficient use of key-based routing in a structured network (\textbf{+G4, +G5}), this approach also results in an unequal load across registrars, especially when the popularity of the topics vary significantly. In particular, the registrars storing popular topics (\ie the ones closest to the hash of the popular topics) would receive a large portion of the registration requests in the network (\textbf{-G3}). Furthermore, in case topic-specific registrars all leave the network, the registration process would have to re-start from scratch causing disturbance in the network (\textbf{-G7}). It is also fairly easy for an attacker to generate Sybil nodes with IDs close to the topic hash and take control over the entire topic-specific traffic (\textbf{-G8}). Incremental solutions have been  proposed to enhance regular \emph{put} and \emph{get} operations by simultaneously using multiple hash functions [\hl{REF}] or increasing the number of nodes storing values for each key[\hl{REF}]. Unfortunately, such approaches only slightly increase the amount of resources a malicious player needs to launch a successful attack against a topic.

%The second solution is for advertisers to place their ads on random registrars across the entire network as currently done by the existing discovery system of Ethereum. This approach is much more difficult to attack as a malicious player would need to take control over the entire network to control a single topic (\textbf{+G8}). Furthermore, random placement is resistant to network dynamics, as registrations are stored on multiple registrars (\textbf{+G7}) and achieves good load balance across registrars regardless of the topic popularity distribution (\textbf{+G3}). On the other hand, random placement makes it difficult for searchers to find placed ads, especially for unpopular topics. The main goal of structured placement (through original Kademlia DHT) is to provide bounded lookup times with good performance for large networks and good scalability. On the other hand, placing registrations in a random way does not provide any of these performance guarantees: either the advertisers must place a large number of ads to simplify the search, or searchers need to consult with potentially a large number of registrars before finding a relevant ad to simplify the registration. Overall, both approaches described above require significant amounts of time (\textbf{-G3}) and additional traffic (\textbf{-G4}).
