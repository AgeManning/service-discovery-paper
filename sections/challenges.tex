\section{Objectives}
\label{sec:objectives}

In this section, we discuss the objectives of \sysname design and describe the challenges involved in achieving them. A comprehensive list of objectives are listed in \Cref{tab:objectives}, and we discuss them under four main categories: security, fairness, load-balancing, and efficiency of the discovery system. 

\para{Security and Fairness} As an open, decentralised system, \sysname must operate securely under a Byzantine environment where adversaries can generate Sybils at no cost and launch various attacks on \sysname to disrupt discovery of and to eclipse peers of target applications (\textbf{G8}). Eclipsing is often a precursor to application-specific attacks such as double spending and stubborn mining. The attacks on \sysname involve adversaries (and their Sybils) abusing their advertiser and registrar roles: 

%XXX Onur: we might want to mention that we don't worry about malicious (e.g., spamming) searchers and explain why. 

\begin{itemize}
 \item \textit{Malicious advertisers} launch \textit{spamming attacks} on the registrars by attempting to register a lot of ads, 
 \item \textit{Malicious registrars} ignore topic queries, \ie Denial-of-Service (DoS), or return either bogus or targeted results (\eg  Sybils) to topic queries.
\end{itemize}

A spamming attack aims to \textit{poison} the limited ad storage resources (\ie \textit{registries}) of the registrars, which are shared by the advertisers across all the topics, with ads by the adversaries and their Sybils. A typical approach to avoid such misuse of resources is to make their consumption costly, for instance, by incorporating a Proof-of-Work (PoW) scheme \hl{[]} into the registration process and requiring advertisers to present proofs of resource consumption before they are allowed to place their ads. However, PoW schemes, although widely-used in decentralised systems, unnecessarily consume and promote pooling of computing resources to create centralised hubs~\cite{gervais2014bitcoin}. 

In addition, \sysname must also ensure \textit{fair allocation} of storage resources by different topics to prevent starvation of unpopular topics (\textbf{G1}). To achieve fair allocation of registry and also securing it against poisoning, registrars must exercise \textit{access control} as part of the registration operations to determine which advertisers' ads are placed. While, an access control mechanism can not completely prevent poisoning attacks in a completely trust-less P2P setting, it should at least make it difficult or expensive for a single adversary to poison registries using its Sybils. As we explain in \Cref{sec:overview}, registrars achieve these objectives by shaping the incoming ad registration requests to prioritise ads that contribute most to the diversity of peers currently stored in their registry.

%Therefore, \sysname (such as the access control) must ensure that adversaries require as many physical machines as possible to launch successful eclipse attacks or disrupt discovery for a target application.

In a structured P2P network, the adversaries can strategically target specific regions in the DHT ID space for placement of both their ads and Sybils (\ie by generating Sybil Node IDs that are within the desired region in the DHT ID space) if that leads to better discoverability for their ads or Sybil registrars. The success of such regional attacks is closely related to the load-balancing performance of \sysname: if the registrations for any topic favor specific regions in the DHT (\ie creating hotspots), then strategically targeting the hotspot regions can significantly amplify the strength of attacks as we demonstrate in Section \hl{X}. 

\para{Load-balancing and Efficiency} With good load-balancing, all the nodes in \sysname incur approximately equal overhead from registration and search operations (\textbf{G3}). In general, we consider \textit{messaging, computational, and state maintenance} aspects of search/registration operations as the main overheads. At the same time, \sysname must provide efficient registration and discovery in terms of overhead burden on the network, timeliness\footnote{Ideally, the topic search should be fast even when the number of advertisers for a topic is much smaller than the number of all live nodes.} and robustness of search/registration operations (\textbf{G4, G5, G6}) despite the volatility of the environment where peers come and go (\textbf{G8}) and existence of access control measures. Also, the efficiency in discovery should apply equally to all the advertisers within a topic so that individually they each have a similar probability of being discovered (\textbf{G2}). 

Because each and every node can be an advertisement medium for any topic, the main challenge in discovery is to find the ``right'' subset of registrars to \textit{distribute the ads} so that search and registration operations efficiently meet at common nodes independent of the topic popularity. The choice of the subset also determines the level of load-balancing across the peers, and consequently it impacts the security as discussed above. Therefore, the \textit{ad distribution} mechanism is central to the \sysname design. Below, we discuss two possible approaches for ad distribution that each use different subsets of nodes as registrars. 

%ddOther important objectives are the efficiency of \sysname in terms of speed of discovery and limiting of messaging, computational and state maintenance overheads at acceptable levels. A timely discovery requires advertisers and searchers for a particular topic to quickly meet at common registrars. 


The first approach is to use the Kademlia (or any other similar DHT implementation), where the default \emph{put} and \emph{get} operations would store all the ads for topics on the (rendezvous) nodes whose IDs are closest to the hash of the topic. Although advertisers and searchers can quickly meet at common registrars with efficient use of key-based routing in a structured network (\textbf{+G4, +G5}), this approach also results in an unequal load across registrars, especially when the popularity of the topics vary significantly. In particular, the registrars storing popular topics (\ie the ones closest to the hash of the popular topics) would receive a large portion of the registration requests in the network (\textbf{-G3}). Furthermore, in case topic-specific registrars all leave the network, the registration process would have to re-start from scratch causing disturbance in the network (\textbf{-G7}). It is also fairly easy for an attacker to generate Sybil nodes with IDs close to the topic hash and take control over the entire topic-specific traffic (\textbf{-G8}). Incremental solutions have been  proposed to enhance regular \emph{put} and \emph{get} operations by simultaneously using multiple hash functions [\hl{REF}] or increasing the number of nodes storing values for each key[\hl{REF}]. Unfortunately, such approaches only slightly increase the amount of resources a malicious player needs to launch a successful attack against a topic. 

The second solution is for  advertisers to place their ads on random advertisers across the entire network as currently done by the existing discovery system of Ethereum. This approach is much more difficult to attack as a malicious player would need to take control over the entire network to control a single topic (\textbf{+G8}). Furthermore, random placement is resistant to network dynamics, as registrations are stored on multiple registrars (\textbf{+G7}) and achieves good load balance across registrars regardless of the topic popularity distribution (\textbf{+G3}). On the other hand, random placement makes it difficult for searchers to find placed ads, especially for unpopular topics. The main goal of structured placement (through original Kademlia DHT) is to provide bounded lookup times with good performance for large networks and good scalability. On the other hand, placing registrations in a random way does not provide any of these performance guarantees: either the advertisers must place a large number of ads to simplify the search, or searchers need to consult with potentially a large number of registrars before finding a relevant ad to simplify the registration. Overall, both approaches described above require significant amounts of time (\textbf{-G3}) and additional traffic (\textbf{-G4}). 

