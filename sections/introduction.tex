%!TEX root = ../main.tex
%=========================================================

\section{Introduction}

Ethereum~\cite{} is a decentralized, open-source blockchain for distributed computing, allowing users to develop various decentralized applications (DApps).  Ethereum  was the first major blockchain to support Turing-complete scripting via smart contracts, Ethereum also operates as a cryptocurrency by supporting the transfer of tokens called ether between Ethereum accounts.
In addition to its use as a fiat currency,  ether is also used to incentivize Ethereum nodes to perform distributed computation. 
Ether can also be converted to gas, which is used as a fee for executing transactions and smart contracts, and effectively mitigates spam. 

Ethereum is the most actively used blockchain~\cite{bloomberg} nowadays.
Following its decentralized design and structure, Ethereum relies on a communication infrastructure provided by a peer-to-peer (P2P) network, where individual and independent nodes, running an Ethereum client software (e.g., Go Ethereum~\cite{go-ethereum}), send and receive messages  containing transactions and blocks to achieve distributed consensus,  without relying on any central node or a trusted third party.

The set of network protocols which form the Ethereum peer-to-peer network are called DEVp2p.  DEVp2p isn't specific to a particular blockchain, but should serve the needs of any networked application associated with the Ethereum umbrella.
Other protocols can also run on top of DEVp2p,  such as 
The Whisper protocol~\cite{} (for decentralized
applications) and the Swarm protocol~\cite{} (for decentralized file
storage).
DEVp2p provides peers connection management and also node discovery services.
%Between the DEVp2p network protocols and the app protocol (i.e., Ethereum, Whisper, Swarm, etc), RLPx~\cite{} provides a secure transport layer. 
%\michal{The above seems too detailed IMO. We can introduce DEV2p, RLPx etc. in the background. I'd only say that Ethereum DHT can be used by other services (not necessarily blockchain related) and give some examples.}

DEVp2p is the responsible of managing the connections to other peers which form the overlay P2P network.
%For instance,  Go-ethereum client by default establish a total of 50  connections to other Ethereum nodes.  Of these 50 slots,  two thirds are reserved for inbound connections (initiated by other peers),  while the remaining third are allocated for outbound connections. 
%No further restrictions apply to inbound connections; if an inbound slot is available
%Go-ethereum client simply accepts any connecting peer that supports the
%Ethereum protocol and operates on the same network (main,
%testing, etc.). 
%The outbound slots are therefore selected by the nodes, which need to be done carefully to avoid any attacker could mount an eclipse attack.
%In an eclipse attack, an
%adversary monopolizes the connections of a victim, effectively
%filtering the victim’s view of the blockchain.  Eclipse attacks
%enable a variety of follow-up attacks such as double spending
%and stubborn mining~\cite{}.
%\michal{ditto}
In order to find and select participants of the P2P network to initiate connections to,  a node discovery protocol is required by DEVp2p.
Systems such as MDNS/Bonjour allow finding hosts,  but only in  a local-area network.  
However, DEVp2p discovery protocol requires to work on the Internet and to be useful for applications with a large number of participants spread across the Internet.
There are systems that uses a rendezvous server for network discovery over the Internet,  such as desktop applications or cloud services. 
But using rendezvous servers requires trust in the operator and these systems are prone to censorship. 
For a decentralized network,  such as the Ethereum network,  it is not desirable to rely on a single operator.  
Instead,  it is better to place a small amount of trust in every participant, becoming more resistant to censorship as the size of the network increases and participants of multiple networks can share the discovery network to further increase its resilience.
%The process of joining the network is the Achilles heel of the node discovery protocol: while any other node may be used as an entry point,  such a node must first be located through some other mechanism.  
%Approaches such as listing of initial entry points in DNS or discovery of participants in the local network can be used,  but only as a reasonable secure entry into the network.

Current version of DEVp2p distributed node discovery protocol is discovery version 5 (Discv5).
Node discovery protocol can be used by any node on the network  at no cost other than running the network protocol and storing a limited number of other nodes' records. 
Any node can be used as an entry point into the network.
Discv5 system's design is loosely inspired by the Kademlia DHT~\cite{}.
%In Kademlia DHT,  information about known overlay nodes is stored in
%a distributed table separated into so-called k-buckets (or simply buckets),  where each bucket stores nodes identifiers within the same distance to the local node id.
%But unlike most DHTs no arbitrary keys and values are stored. 
%Instead, the DHT stores and relays 'node records', which are signed documents providing information about nodes in the network. 
Discv5 acts as a database of all live nodes in the network %and performs three basic functions:
and,  by walking the DHT,  all nodes of the network can be discovered and enumerated.

%\begin{itemize}
% \item Sampling the set of all live participants: by walking the DHT,  the network can be enumerated.
% \item Searching for participants providing a certain service: Discv5 includes a scalable facility for registering 'topic advertisements'. These advertisements can be queried and nodes advertising a topic found.
% \item Authoritative resolution of node records: if a node's ID is known, the most recent version of its record can be retrieved.
%\end{itemize}

The concept of topic is a new concept in Discv5 (compared with previous node discovery protocol -Discv4-),  
Discv5 will allow nodes to associate themselves with a set of tags, i.e., topics, and enable searching of peers that advertise themselves as associated with particular topics.  
Topics can be used to identify different  capabilities, for instance specific application capabilities,  services or certain functionalities of a node. 
\hl{Topics example missing}
Topic based peer finding is a promising feature because it allows a potential bandwidth reduction and much faster discovery of nodes
by  discovering nodes based on the topic required.
This means that instead of connecting to every node discovered to see if it offers a specific service,  a node can simply lookup for nodes that are only providing the service and then ask them if they really are still offering the service.
This will avoid a waste of time and resources by leaving apart those nodes that do not declare the service in its capabilities,  avoiding handshakes node by node to discover these details and relying only on the node discovery protocol. 

However,  Discv5 still lacks of mechanisms to register and discover nodes for specific topics.
Providing new mechanisms for registering and discovering for specific topics in Discv5 is challenging because of the decentralized structure of the network and its vulnerability to Sybil attacks~\cite{} (any node joining the network can be a malicious node) adds complexity to any proposed solution that has to work for any kind of service despite its popularity.

%\michal{I'd write the intro on a higher level. E.g., 1) Ethereum is the largest network/blockchain 2) It is fully decentralized and decentralization is great 3) Ethereum allows hosting multiple services other than Ethereum blockchain) and uses Ethereum DHT as a communication/management platform 4) A crucial part of that is to enable nodes working with the same application to find each other 5) this is challenging because of decentralization/security/malicious can join etc. 6) State of the Art doesn't work (briefly - we have better analysis in related work) 7) We propose our brand new shiny protocol that is efficiency and secure 8) Our contributions + structure}


%It is envisioned that the Discv5 system will be used across many different services at large scale, mainly to form subnetworks consisting of the service peers.  The basic objectives of Node Discovery v5 is to provide a facility for nodes to i) register 'topic advertisements', i.e., “ads”, at other peers in the Ethereum network and ii) find other nodes that advertised a particular topic by querying selected peers in the Ethereum network.

The goal of this paper is to propose and evaluate a new mechanism for the Discv5 protocol for registering and discovery nodes in the network for a certain topic,  integrating it in the existing DEVp2p node discovery protocol based on Kademlia DHT.  
The new mechanism is capable of registering and discovering for services in the Ethereum P2P network efficiently for any service regardless of the popularity of the service, using a bounded number of hops and resistant to Sybil attacks.
\hl{Any missing nice feature of the proposal}.

The mechanisms proposed are the following:

\begin{itemize}
 \item New registering mechanism that register nodes only for the topics that matches nodes capabilities.
 \item New table structure on top of the existing Kademlia DHT to store node information based on topics advertised.
 \item New lookup mechanism that discover nodes based on the topics advertised in the P2P network.
\end{itemize}
    
The structure of the paper is the following....\hl{TBC}
